{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","$","window","resize","onResize","Chairs","About","fixWidows","each","string","html","replace","hideLoading","addClass","tail","tailSize","listSize","bufferTime","imgDirPath","lastChairTime","stop","imagesContainer","document","querySelector","currentPosition","getSecsToday","isDev","initTail","bind","location","hash","addEventListener","handleVisibilityChange","hidden","reinitTail","loadTail","appendImages","triggerTimer","clearChairs","i","length","append","generateImage","delay","setTimeout","requestAnimationFrame","nextChair","currentDate","Date","passedASecond","console","log","shiftChair","pushChair","first","remove","image","formatName","base","padNumber","filename","imageHolder","createElement","className","id","setAttribute","appendChild","date","getSeconds","getMinutes","getHours","num","s","floorToSeconds","timestamp","Math","floor","ceilToSeconds","ceil","thinkOf","bindClicks","switchThinkOf","$currentItem","removeClass","next","setInterval","on","animate","scrollTop","height","jQuery","ready"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global jQuery, $, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    _this.Chairs.init();\n    _this.About.init();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  hideLoading: function() {\n    $('#loading-screen').addClass('hide');\n  }\n\n\n};\n\nSite.Chairs = {\n  tail: [],\n  tailSize: 9,\n  listSize: 86400, // = 24hrs\n  bufferTime: 4, // in seconds\n  imgDirPath: 'http://d1r8hiz683c1rx.cloudfront.net/',\n  lastChairTime: null,\n  stop: false,\n  init: function() {\n    var _this = this;\n\n    _this.imagesContainer = document.querySelector('#images-container');\n\n    _this.currentPosition = _this.getSecsToday() + _this.bufferTime;\n\n    if (_this.isDev()) {\n      _this.currentPosition = 1;\n      _this.listSize = 120;\n      _this.imgDirPath = '/dev_chairs/';\n    }\n\n    _this.initTail();\n    _this.bind();\n  },\n\n  isDev: function() {\n    return location.hash === '#dev' ? true : false;\n  },\n\n  bind: function() {\n    var _this = this;\n\n    document.addEventListener(\"visibilitychange\", _this.handleVisibilityChange.bind(_this), false);\n  },\n\n  handleVisibilityChange: function() {\n    var _this = this;\n\n    if (document.hidden) { // INACTIVE TAB\n      _this.stop = true;\n    } else { // ACTIVE TAB\n      _this.reinitTail();\n    }\n  },\n\n  initTail: function() {\n    var _this = this;\n\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(_this.bufferTime * 1000);\n  },\n\n  reinitTail: function() {\n    var _this = this;\n\n    _this.stop = false;\n    _this.currentPosition = _this.getSecsToday();\n\n    if (_this.isDev()) {\n      _this.currentPosition = 60;\n    }\n\n    _this.clearChairs()\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(0);\n  },\n\n  loadTail: function() {\n    var _this = this;\n\n    for (var i = 0; i <= _this.tailSize; i++) {\n      _this.tail[i] = i + _this.currentPosition;\n    }\n  },\n\n  appendImages: function() {\n    var _this = this;\n\n    for (var i = 0; i < _this.tail.length; i++) {\n      _this.imagesContainer.append(_this.generateImage(_this.tail[i]));\n    }\n  },\n\n  triggerTimer: function(delay) {\n    var _this = this;\n\n    setTimeout(function() {\n\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n\n      Site.hideLoading();\n    }, delay);\n\n  },\n\n  nextChair: function() {\n    var _this = this;\n\n    var currentDate = +new Date;\n\n    if (_this.lastChairTime === null) {\n      _this.lastChairTime = currentDate;\n    }\n\n    if (_this.passedASecond(currentDate)) {\n      console.log(currentDate - _this.lastChairTime);\n      _this.currentPosition += 1;\n\n      if( _this.currentPosition > _this.listSize ) {\n        _this.currentPosition = 1;\n      }\n\n      _this.shiftChair();\n      _this.pushChair();\n      _this.lastChairTime = currentDate;\n    }\n\n    if(!_this.stop) {\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n    }\n\n  },\n\n  passedASecond: function(currentDate) {\n    var _this = this;\n\n    if(currentDate - _this.lastChairTime >= 1000) {\n      return true;\n    }\n\n    return false;\n\n  },\n\n  shiftChair: function() {\n    var _this = this;\n\n    $('.image-holder').first().remove();\n  },\n\n  clearChairs: function() {\n    var _this = this;\n\n    $('.image-holder').remove();\n  },\n\n  pushChair: function() {\n    var _this = this;\n\n    var image = _this.currentPosition + _this.tailSize;\n    _this.imagesContainer.append(_this.generateImage(image));\n  },\n\n  formatName: function(base) {\n    var _this = this;\n\n    return _this.padNumber(base) + \".jpeg\";\n  },\n\n  generateImage: function(base) {\n    var _this = this;\n\n    var filename = _this.formatName(base);\n    var imageHolder = document.createElement('div');\n    var image = document.createElement('img');\n\n    imageHolder.className = 'image-holder grid-row justify-center align-items-center';\n    imageHolder.id = 'image-' + base;\n\n    image.setAttribute('src', _this.imgDirPath + filename);\n\n    imageHolder.appendChild(image);\n\n    return imageHolder;\n  },\n\n  // Return number of seconds since last midnight\n  getSecsToday: function() {\n    var date = new Date();\n    return date.getSeconds() + (60 * (date.getMinutes() + (60 * date.getHours())));\n  },\n\n  padNumber: function(num) {\n    var s = num+\"\";\n\n    while(s.length < 4) {\n      s = \"0\" + s;\n    }\n\n    return s;\n  },\n\n  floorToSeconds: function(timestamp) {\n    return Math.floor(timestamp/1000) * 1000;\n  },\n\n  ceilToSeconds: function(timestamp) {\n    return Math.ceil(timestamp/1000) * 1000;\n  }\n\n};\n\nSite.About = {\n  init: function() {\n    var _this = this;\n\n    _this.thinkOf();\n\n    _this.bindClicks();\n  },\n\n  thinkOf: function() {\n    var switchThinkOf = function() {\n      var $currentItem = $('.think-of-item.show');\n\n      $('.think-of-item.show').removeClass('show');\n\n      if ($currentItem.next('.think-of-item').length) {\n        $currentItem.next().addClass('show');\n      } else {\n        $('.think-of-item:first-of-type').addClass('show');\n      }\n    };\n\n    window.setInterval(switchThinkOf, 2000);\n  },\n\n  bindClicks: function() {\n    var _this = this;\n\n    $('#info-button').on('click', function() {\n      $('html, body').animate({\n        scrollTop: $(document).height() - $(window).height()\n      });\n    });\n\n    $('.image-holder').on('click', function() {\n      $('html, body').animate({\n        scrollTop: 0\n      });\n    });\n  },\n\n},\n\njQuery(document).ready(function() {\n  'use strict';\n  Site.init();\n});\n"]}