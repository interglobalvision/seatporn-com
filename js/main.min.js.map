{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","$","window","resize","onResize","Chairs","About","fixWidows","each","string","html","replace","hideLoading","addClass","tail","tailSize","listSize","bufferTime","imgDirPath","lastChairTime","stop","$imagesContainer","currentPosition","getSecsToday","isDev","initTail","bind","location","hash","document","addEventListener","handleVisibilityChange","hidden","reinitTail","loadTail","appendImages","triggerTimer","clearChairs","i","length","append","generateImage","delay","setTimeout","requestAnimationFrame","nextChair","currentDate","Date","passedASecond","shiftChair","pushChair","first","remove","image","formatName","base","padNumber","filename","imageHolder","createElement","className","id","setAttribute","appendChild","date","getSeconds","getMinutes","getHours","num","s","floorToSeconds","timestamp","Math","floor","ceilToSeconds","ceil","thinkOf","bindClicks","switchThinkOf","$currentItem","removeClass","next","setInterval","on","windowHeight","height","footerHeight","outerHeight","footerTop","animate","scrollTop","jQuery","ready"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global jQuery, $, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    _this.Chairs.init();\n    _this.About.init();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  hideLoading: function() {\n    $('#loading-screen').addClass('hide');\n  }\n\n\n};\n\nSite.Chairs = {\n  tail: [],\n  tailSize: 9,\n  listSize: 86400, // = 24hrs\n  bufferTime: 4, // in seconds\n  imgDirPath: 'http://d1r8hiz683c1rx.cloudfront.net/',\n  lastChairTime: null,\n  stop: false,\n  init: function() {\n    var _this = this;\n\n    _this.$imagesContainer = $('#images-container');\n\n    _this.currentPosition = _this.getSecsToday() + _this.bufferTime;\n\n    if (_this.isDev()) {\n      _this.currentPosition = 1;\n      _this.listSize = 120;\n      _this.imgDirPath = '/dev_chairs/';\n    }\n\n    _this.initTail();\n    _this.bind();\n  },\n\n  isDev: function() {\n    return location.hash === '#dev' ? true : false;\n  },\n\n  bind: function() {\n    var _this = this;\n\n    document.addEventListener(\"visibilitychange\", _this.handleVisibilityChange.bind(_this), false);\n  },\n\n  handleVisibilityChange: function() {\n    var _this = this;\n\n    if (document.hidden) { // INACTIVE TAB\n      _this.stop = true;\n    } else { // ACTIVE TAB\n      _this.reinitTail();\n    }\n  },\n\n  initTail: function() {\n    var _this = this;\n\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(_this.bufferTime * 1000);\n  },\n\n  reinitTail: function() {\n    var _this = this;\n\n    _this.stop = false;\n    _this.currentPosition = _this.getSecsToday();\n\n    if (_this.isDev()) {\n      _this.currentPosition = 60;\n    }\n\n    _this.clearChairs()\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(0);\n  },\n\n  loadTail: function() {\n    var _this = this;\n\n    for (var i = 0; i <= _this.tailSize; i++) {\n      _this.tail[i] = i + _this.currentPosition;\n    }\n  },\n\n  appendImages: function() {\n    var _this = this;\n\n    for (var i = 0; i < _this.tail.length; i++) {\n      _this.$imagesContainer.append(_this.generateImage(_this.tail[i]));\n    }\n  },\n\n  triggerTimer: function(delay) {\n    var _this = this;\n\n    setTimeout(function() {\n\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n\n      Site.hideLoading();\n    }, delay);\n\n  },\n\n  nextChair: function() {\n    var _this = this;\n\n    var currentDate = +new Date;\n\n    if (_this.lastChairTime === null) {\n      _this.lastChairTime = currentDate;\n    }\n\n    if (_this.passedASecond(currentDate)) {\n      _this.currentPosition += 1;\n\n      if( _this.currentPosition > _this.listSize ) {\n        _this.currentPosition = 1;\n      }\n\n      _this.shiftChair();\n      _this.pushChair();\n      _this.lastChairTime = currentDate;\n    }\n\n    if(!_this.stop) {\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n    }\n\n  },\n\n  passedASecond: function(currentDate) {\n    var _this = this;\n\n    if(currentDate - _this.lastChairTime >= 1000) {\n      return true;\n    }\n\n    return false;\n\n  },\n\n  shiftChair: function() {\n    var _this = this;\n\n    $('.image-holder').first().remove();\n  },\n\n  clearChairs: function() {\n    var _this = this;\n\n    $('.image-holder').remove();\n  },\n\n  pushChair: function() {\n    var _this = this;\n\n    var image = _this.currentPosition + _this.tailSize;\n    _this.$imagesContainer.append(_this.generateImage(image));\n  },\n\n  formatName: function(base) {\n    var _this = this;\n\n    return _this.padNumber(base) + \".jpeg\";\n  },\n\n  generateImage: function(base) {\n    var _this = this;\n\n    var filename = _this.formatName(base);\n    var imageHolder = document.createElement('div');\n    var image = document.createElement('img');\n\n    imageHolder.className = 'image-holder grid-row justify-center align-items-center';\n    imageHolder.id = 'image-' + base;\n\n    image.setAttribute('src', _this.imgDirPath + filename);\n\n    imageHolder.appendChild(image);\n\n    return imageHolder;\n  },\n\n  // Return number of seconds since last midnight\n  getSecsToday: function() {\n    var date = new Date();\n    return date.getSeconds() + (60 * (date.getMinutes() + (60 * date.getHours())));\n  },\n\n  padNumber: function(num) {\n    var s = num+\"\";\n\n    while(s.length < 4) {\n      s = \"0\" + s;\n    }\n\n    return s;\n  },\n\n  floorToSeconds: function(timestamp) {\n    return Math.floor(timestamp/1000) * 1000;\n  },\n\n  ceilToSeconds: function(timestamp) {\n    return Math.ceil(timestamp/1000) * 1000;\n  }\n\n};\n\nSite.About = {\n  init: function() {\n    var _this = this;\n\n    _this.thinkOf();\n\n    _this.bindClicks();\n  },\n\n  thinkOf: function() {\n    var switchThinkOf = function() {\n      var $currentItem = $('.think-of-item.show');\n\n      $('.think-of-item.show').removeClass('show');\n\n      if ($currentItem.next('.think-of-item').length) {\n        $currentItem.next().addClass('show');\n      } else {\n        $('.think-of-item:first-of-type').addClass('show');\n      }\n    };\n\n    window.setInterval(switchThinkOf, 2000);\n  },\n\n  bindClicks: function() {\n    var _this = this;\n\n    $('#info-button').on('click', function() {\n      var windowHeight = $(window).height();\n      var footerHeight = $('#footer').outerHeight(true);\n\n      if (windowHeight > footerHeight) {\n        var footerTop = windowHeight - footerHeight;\n      } else {\n        var footerTop = footerHeight - windowHeight;\n      }\n\n      $('body').animate({\n          scrollTop: footerTop,\n      });\n    });\n\n    $('#images-container').on('click', function() {\n      $('body').animate({\n        scrollTop: 0,\n      });\n    });\n  },\n\n},\n\njQuery(document).ready(function() {\n  'use strict';\n  Site.init();\n});\n"]}