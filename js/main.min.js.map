{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","$","window","resize","onResize","Chairs","About","fixWidows","each","string","html","replace","hideLoading","addClass","tail","tailSize","listSize","bufferTime","imgDirPath","lastChairTime","stop","imagesContainer","document","querySelector","currentPosition","getSecsToday","isDev","initTail","bind","location","hash","addEventListener","handleVisibilityChange","hidden","reinitTail","loadTail","appendImages","triggerTimer","clearChairs","i","length","append","generateImage","delay","setTimeout","requestAnimationFrame","nextChair","currentDate","Date","passedASecond","shiftChair","pushChair","first","remove","image","formatName","base","padNumber","filename","imageHolder","createElement","className","id","setAttribute","appendChild","date","getSeconds","getMinutes","getHours","num","s","floorToSeconds","timestamp","Math","floor","ceilToSeconds","ceil","thinkOf","bindClicks","switchThinkOf","$currentItem","removeClass","next","setInterval","on","animate","scrollTop","height","jQuery","ready"],"mappings":"AAGAA,MACEC,gBAAiB,IACjBC,KAAM,WACJ,GAAIC,GAAQC,IAEZC,GAAEC,QAAQC,OAAO,WACfJ,EAAMK,aAGRL,EAAMM,OAAOP,OACbC,EAAMO,MAAMR,QAGdM,SAAU,aAKVG,UAAW,WAETN,EAAE,kBAAkBO,KAAK,WACvB,GAAIC,GAASR,EAAED,MAAMU,MACrBD,GAASA,EAAOE,QAAQ,YAAY,YACpCV,EAAED,MAAMU,KAAKD,MAIjBG,YAAa,WACXX,EAAE,mBAAmBY,SAAS,UAMlCjB,KAAKS,QACHS,QACAC,SAAU,EACVC,SAAU,MACVC,WAAY,EACZC,WAAY,wCACZC,cAAe,KACfC,MAAM,EACNtB,KAAM,WACJ,GAAIC,GAAQC,IAEZD,GAAMsB,gBAAkBC,SAASC,cAAc,qBAE/CxB,EAAMyB,gBAAkBzB,EAAM0B,eAAiB1B,EAAMkB,WAEjDlB,EAAM2B,UACR3B,EAAMyB,gBAAkB,EACxBzB,EAAMiB,SAAW,IACjBjB,EAAMmB,WAAa,gBAGrBnB,EAAM4B,WACN5B,EAAM6B,QAGRF,MAAO,WACL,MAAyB,SAAlBG,SAASC,MAGlBF,KAAM,WACJ,GAAI7B,GAAQC,IAEZsB,UAASS,iBAAiB,mBAAoBhC,EAAMiC,uBAAuBJ,KAAK7B,IAAQ,IAG1FiC,uBAAwB,WACtB,GAAIjC,GAAQC,IAERsB,UAASW,OACXlC,EAAMqB,MAAO,EAEbrB,EAAMmC,cAIVP,SAAU,WACR,GAAI5B,GAAQC,IAEZD,GAAMoC,WACNpC,EAAMqC,eACNrC,EAAMsC,aAAgC,IAAnBtC,EAAMkB,aAG3BiB,WAAY,WACV,GAAInC,GAAQC,IAEZD,GAAMqB,MAAO,EACbrB,EAAMyB,gBAAkBzB,EAAM0B,eAE1B1B,EAAM2B,UACR3B,EAAMyB,gBAAkB,IAG1BzB,EAAMuC,cACNvC,EAAMoC,WACNpC,EAAMqC,eACNrC,EAAMsC,aAAa,IAGrBF,SAAU,WAGR,IAAK,GAFDpC,GAAQC,KAEHuC,EAAI,EAAGA,GAAKxC,EAAMgB,SAAUwB,IACnCxC,EAAMe,KAAKyB,GAAKA,EAAIxC,EAAMyB,iBAI9BY,aAAc,WAGZ,IAAK,GAFDrC,GAAQC,KAEHuC,EAAI,EAAGA,EAAIxC,EAAMe,KAAK0B,OAAQD,IACrCxC,EAAMsB,gBAAgBoB,OAAO1C,EAAM2C,cAAc3C,EAAMe,KAAKyB,MAIhEF,aAAc,SAASM,GACrB,GAAI5C,GAAQC,IAEZ4C,YAAW,WAET1C,OAAO2C,sBAAsB9C,EAAM+C,UAAUlB,KAAK7B,IAElDH,KAAKgB,eACJ+B,IAILG,UAAW,WACT,GAAI/C,GAAQC,KAER+C,GAAe,GAAIC,KAEK,QAAxBjD,EAAMoB,gBACRpB,EAAMoB,cAAgB4B,GAGpBhD,EAAMkD,cAAcF,KACtBhD,EAAMyB,iBAAmB,EAErBzB,EAAMyB,gBAAkBzB,EAAMiB,WAChCjB,EAAMyB,gBAAkB,GAG1BzB,EAAMmD,aACNnD,EAAMoD,YACNpD,EAAMoB,cAAgB4B,GAGpBhD,EAAMqB,MACRlB,OAAO2C,sBAAsB9C,EAAM+C,UAAUlB,KAAK7B,KAKtDkD,cAAe,SAASF,GACtB,GAAIhD,GAAQC,IAEZ,OAAG+C,GAAchD,EAAMoB,eAAiB,KAQ1C+B,WAAY,WAGVjD,EAAE,iBAAiBmD,QAAQC,UAG7Bf,YAAa,WAGXrC,EAAE,iBAAiBoD,UAGrBF,UAAW,WACT,GAAIpD,GAAQC,KAERsD,EAAQvD,EAAMyB,gBAAkBzB,EAAMgB,QAC1ChB,GAAMsB,gBAAgBoB,OAAO1C,EAAM2C,cAAcY,KAGnDC,WAAY,SAASC,GACnB,GAAIzD,GAAQC,IAEZ,OAAOD,GAAM0D,UAAUD,GAAQ,SAGjCd,cAAe,SAASc,GACtB,GAAIzD,GAAQC,KAER0D,EAAW3D,EAAMwD,WAAWC,GAC5BG,EAAcrC,SAASsC,cAAc,OACrCN,EAAQhC,SAASsC,cAAc,MASnC,OAPAD,GAAYE,UAAY,0DACxBF,EAAYG,GAAK,SAAWN,EAE5BF,EAAMS,aAAa,MAAOhE,EAAMmB,WAAawC,GAE7CC,EAAYK,YAAYV,GAEjBK,GAITlC,aAAc,WACZ,GAAIwC,GAAO,GAAIjB,KACf,OAAOiB,GAAKC,aAAgB,IAAMD,EAAKE,aAAgB,GAAKF,EAAKG,aAGnEX,UAAW,SAASY,GAGlB,IAFA,GAAIC,GAAID,EAAI,GAENC,EAAE9B,OAAS,GACf8B,EAAI,IAAMA,CAGZ,OAAOA,IAGTC,eAAgB,SAASC,GACvB,MAAoC,KAA7BC,KAAKC,MAAMF,EAAU,MAG9BG,cAAe,SAASH,GACtB,MAAmC,KAA5BC,KAAKG,KAAKJ,EAAU,OAK/B5E,KAAKU,OACHR,KAAM,WACJ,GAAIC,GAAQC,IAEZD,GAAM8E,UAEN9E,EAAM+E,cAGRD,QAAS,WACP,GAAIE,GAAgB,WAClB,GAAIC,GAAe/E,EAAE,sBAErBA,GAAE,uBAAuBgF,YAAY,QAEjCD,EAAaE,KAAK,kBAAkB1C,OACtCwC,EAAaE,OAAOrE,SAAS,QAE7BZ,EAAE,gCAAgCY,SAAS,QAI/CX,QAAOiF,YAAYJ,EAAe,MAGpCD,WAAY,WAGV7E,EAAE,gBAAgBmF,GAAG,QAAS,WAC5BnF,EAAE,cAAcoF,SACdC,UAAWrF,EAAEqB,UAAUiE,SAAWtF,EAAEC,QAAQqF,aAIhDtF,EAAE,iBAAiBmF,GAAG,QAAS,WAC7BnF,EAAE,cAAcoF,SACdC,UAAW,QAOnBE,OAAOlE,UAAUmE,MAAM,WACrB,YACA7F,MAAKE","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global jQuery, $, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    _this.Chairs.init();\n    _this.About.init();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  hideLoading: function() {\n    $('#loading-screen').addClass('hide');\n  }\n\n\n};\n\nSite.Chairs = {\n  tail: [],\n  tailSize: 9,\n  listSize: 86400, // = 24hrs\n  bufferTime: 4, // in seconds\n  imgDirPath: 'http://d1r8hiz683c1rx.cloudfront.net/',\n  lastChairTime: null,\n  stop: false,\n  init: function() {\n    var _this = this;\n\n    _this.imagesContainer = document.querySelector('#images-container');\n\n    _this.currentPosition = _this.getSecsToday() + _this.bufferTime;\n\n    if (_this.isDev()) {\n      _this.currentPosition = 1;\n      _this.listSize = 120;\n      _this.imgDirPath = '/dev_chairs/';\n    }\n\n    _this.initTail();\n    _this.bind();\n  },\n\n  isDev: function() {\n    return location.hash === '#dev' ? true : false;\n  },\n\n  bind: function() {\n    var _this = this;\n\n    document.addEventListener(\"visibilitychange\", _this.handleVisibilityChange.bind(_this), false);\n  },\n\n  handleVisibilityChange: function() {\n    var _this = this;\n\n    if (document.hidden) { // INACTIVE TAB\n      _this.stop = true;\n    } else { // ACTIVE TAB\n      _this.reinitTail();\n    }\n  },\n\n  initTail: function() {\n    var _this = this;\n\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(_this.bufferTime * 1000);\n  },\n\n  reinitTail: function() {\n    var _this = this;\n\n    _this.stop = false;\n    _this.currentPosition = _this.getSecsToday();\n\n    if (_this.isDev()) {\n      _this.currentPosition = 60;\n    }\n\n    _this.clearChairs()\n    _this.loadTail();\n    _this.appendImages();\n    _this.triggerTimer(0);\n  },\n\n  loadTail: function() {\n    var _this = this;\n\n    for (var i = 0; i <= _this.tailSize; i++) {\n      _this.tail[i] = i + _this.currentPosition;\n    }\n  },\n\n  appendImages: function() {\n    var _this = this;\n\n    for (var i = 0; i < _this.tail.length; i++) {\n      _this.imagesContainer.append(_this.generateImage(_this.tail[i]));\n    }\n  },\n\n  triggerTimer: function(delay) {\n    var _this = this;\n\n    setTimeout(function() {\n\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n\n      Site.hideLoading();\n    }, delay);\n\n  },\n\n  nextChair: function() {\n    var _this = this;\n\n    var currentDate = +new Date;\n\n    if (_this.lastChairTime === null) {\n      _this.lastChairTime = currentDate;\n    }\n\n    if (_this.passedASecond(currentDate)) {\n      _this.currentPosition += 1;\n\n      if( _this.currentPosition > _this.listSize ) {\n        _this.currentPosition = 1;\n      }\n\n      _this.shiftChair();\n      _this.pushChair();\n      _this.lastChairTime = currentDate;\n    }\n\n    if(!_this.stop) {\n      window.requestAnimationFrame(_this.nextChair.bind(_this));\n    }\n\n  },\n\n  passedASecond: function(currentDate) {\n    var _this = this;\n\n    if(currentDate - _this.lastChairTime >= 1000) {\n      return true;\n    }\n\n    return false;\n\n  },\n\n  shiftChair: function() {\n    var _this = this;\n\n    $('.image-holder').first().remove();\n  },\n\n  clearChairs: function() {\n    var _this = this;\n\n    $('.image-holder').remove();\n  },\n\n  pushChair: function() {\n    var _this = this;\n\n    var image = _this.currentPosition + _this.tailSize;\n    _this.imagesContainer.append(_this.generateImage(image));\n  },\n\n  formatName: function(base) {\n    var _this = this;\n\n    return _this.padNumber(base) + \".jpeg\";\n  },\n\n  generateImage: function(base) {\n    var _this = this;\n\n    var filename = _this.formatName(base);\n    var imageHolder = document.createElement('div');\n    var image = document.createElement('img');\n\n    imageHolder.className = 'image-holder grid-row justify-center align-items-center';\n    imageHolder.id = 'image-' + base;\n\n    image.setAttribute('src', _this.imgDirPath + filename);\n\n    imageHolder.appendChild(image);\n\n    return imageHolder;\n  },\n\n  // Return number of seconds since last midnight\n  getSecsToday: function() {\n    var date = new Date();\n    return date.getSeconds() + (60 * (date.getMinutes() + (60 * date.getHours())));\n  },\n\n  padNumber: function(num) {\n    var s = num+\"\";\n\n    while(s.length < 4) {\n      s = \"0\" + s;\n    }\n\n    return s;\n  },\n\n  floorToSeconds: function(timestamp) {\n    return Math.floor(timestamp/1000) * 1000;\n  },\n\n  ceilToSeconds: function(timestamp) {\n    return Math.ceil(timestamp/1000) * 1000;\n  }\n\n};\n\nSite.About = {\n  init: function() {\n    var _this = this;\n\n    _this.thinkOf();\n\n    _this.bindClicks();\n  },\n\n  thinkOf: function() {\n    var switchThinkOf = function() {\n      var $currentItem = $('.think-of-item.show');\n\n      $('.think-of-item.show').removeClass('show');\n\n      if ($currentItem.next('.think-of-item').length) {\n        $currentItem.next().addClass('show');\n      } else {\n        $('.think-of-item:first-of-type').addClass('show');\n      }\n    };\n\n    window.setInterval(switchThinkOf, 2000);\n  },\n\n  bindClicks: function() {\n    var _this = this;\n\n    $('#info-button').on('click', function() {\n      $('html, body').animate({\n        scrollTop: $(document).height() - $(window).height()\n      });\n    });\n\n    $('.image-holder').on('click', function() {\n      $('html, body').animate({\n        scrollTop: 0\n      });\n    });\n  },\n\n},\n\njQuery(document).ready(function() {\n  'use strict';\n  Site.init();\n});\n"]}